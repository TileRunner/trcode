(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{2389:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return j}});var i=a(5893),t=a(1385),n=a(7294),c=a(1664),r=a(3625),l=a(8520),o=a(9477),d=a(798),m=a(7666),h=a(6595),u=a(1489),p=a(4946);var b=a(3939),x=function(e){var s="pbTileOnRack Unselected "+("Q"===e.tilevalue?"u ":"")+e.participant;return(0,i.jsx)("div",{className:s,children:(0,i.jsx)("div",{className:"pbTileOnRackText",children:e.tilevalue})},e.tileindex)},j=function(e){var s=e.client,a=e.wsmessage,j=e.gameid,w=e.nickname,f=e.participant,v=(0,n.useState)(0),N=v[0],k=v[1],g=(0,n.useState)({pname:"loading...",gname:"loading...",moves:[],snapshots:[{tiles:[],ptiles:[],gtiles:[],rescues:0,whoseturn:"P"}]}),y=g[0],S=g[1],C=(0,n.useState)([]),T=C[0],F=C[1];(0,n.useEffect)((function(){s.send({gameid:j,type:"pb",sender:h.Vj,func:"startExamining"})}),[]),(0,n.useEffect)((function(){""!==a&&function(e){var s=JSON.parse(e);if(s.gameid===j&&"pb"===s.type){if("providegamedata"===s.func){var a=function(e){for(var s=[],a=e,i="",t="",n="",c=(0,u.$)(a.racksize),r=[],l=0,o=0;o<a.events.length;o++){var d=a.events[o];if(d.ptiles&&(i=d.ptiles),d.gtiles&&(t=d.gtiles),"STARTGAME"!==d.type&&d.type!==h.bS&&d.type!==h.Ix||(n=d.tiles),d.type===h.bS||d.type===h.Ix||d.type===h.Am){var m={by:d.by,type:d.type};if(d.type===h.bS){m.mainword=d.mainword,m.extrawords=d.extrawords.split(","),m.pos=d.pos,d.by===h.ap&&(l=d.rescues);for(var b=(0,p.F)(d.pos),x=b.row,j=b.col,w=0;w<d.mainword.length;w++){var f=c[x][j];f.usedby===h.i4&&(f.usedby=d.by,f.letter=d.mainword[w]),b.dir===h.oW?j++:x++}}r.push(m)}s.push({tiles:n.split(""),squareArray:JSON.parse(JSON.stringify(c)),ptiles:i.split(""),gtiles:t.split(""),rescues:l,whoseturn:d.whoseturn})}return{pname:a.pname,gname:a.gname,moves:r,racksize:a.racksize,snapshots:s}}(s.apidata);S(a)}if("chat"===s.func){var i=[].concat((0,t.Z)(T),[{from:s.nickname,msg:s.sendmsg}]);F(i)}}}(a)}),[a]),(0,n.useEffect)((function(){(0,b.O)("ScrollableChat")}),[T]);var z=function(){N+1<y.snapshots.length&&k(N+1)},G=function(){return y.snapshots[N].whoseturn===h.kX},P=function(){return y.snapshots[N].whoseturn===h.Ov};return(0,i.jsxs)("div",{className:"prisonbreak",children:[(0,i.jsxs)("div",{className:"w3-display-container w3-teal topBarHeight",children:[(0,i.jsx)("div",{className:"w3-display-middle",children:(0,i.jsx)("h1",{className:"myHeadingFont",children:"Prison Break"})}),(0,i.jsxs)("div",{className:"w3-display-topleft w3-black topBarCorner commonFontFamily",children:["Game id: ",j]}),(0,i.jsxs)("div",{className:"w3-display-bottomleft w3-orange topBarCorner commonFontFamily",children:["Prisoners: ",y.pname]}),(0,i.jsx)("div",{className:"w3-display-topright w3-black topBarCorner commonFontFamily",children:(0,i.jsx)(c.default,{href:"../../",children:(0,i.jsx)("a",{children:(0,i.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})}),(0,i.jsxs)("div",{className:"w3-display-bottomright w3-orange topBarCorner commonFontFamily",children:["Guards: ",y.gname]})]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"col pbTileAndMovesOuter",children:[(0,i.jsx)(l.default,{tiles:y.snapshots[N].tiles,othertiles:G()?y.snapshots[N].gtiles:P()?y.snapshots[N].ptiles:[]}),(0,i.jsx)(o.default,{moves:y.moves.slice(0,N),onmoveclick:function(e){return function(e){var s=e;e+1<y.snapshots.length&&k(s)}(e)}})]}),(0,i.jsx)("div",{className:"col pbPlayerOuterSection",children:(0,i.jsxs)("div",{className:"pbPlayerInnerSection",children:[(0,i.jsxs)("div",{className:"pbPlayerTitle",children:[(0,i.jsx)("i",{className:"material-icons",children:h._k}),"\xa0",h.Ji,"\xa0",(0,i.jsx)("i",{className:"material-icons",children:h._k})]}),(0,i.jsxs)("div",{className:"pbTilerack",children:[y.snapshots[N].whoseturn===h.ap&&(0,i.jsx)("div",{className:"pbTilerackArrow",onClick:z}),y.snapshots[N].ptiles.map((function(e,s){return(0,i.jsx)(x,{participant:h.ap,tilevalue:P()?"*":e,tileindex:s},"ObserverPrisonersRackTile".concat(s))}))]}),(0,i.jsxs)("div",{className:"pbPlayerTitle",children:[(0,i.jsx)("i",{className:"material-icons",children:h.g9}),"\xa0",h.jN,"\xa0",(0,i.jsx)("i",{className:"material-icons",children:h.g9})]}),(0,i.jsxs)("div",{className:"pbTilerack",children:[y.snapshots[N].whoseturn===h.b6&&(0,i.jsx)("div",{className:"pbTilerackArrow",onClick:z}),y.snapshots[N].gtiles.map((function(e,s){return(0,i.jsx)(x,{participant:h.b6,tilevalue:G()?"*":e,tileindex:s},"ObserverGuardsRackTile".concat(s))}))]})]})}),(0,i.jsx)("div",{className:"col",children:(0,i.jsx)("div",{className:"row",children:(0,i.jsx)(r.default,{squareArray:y.snapshots[N].squareArray,rcd:[-1,-1,h.QY],onClick:function(e,s){return function(e,s){for(var a=-1,i=0;i<y.snapshots.length;i++){var t=y.snapshots[i];-1===a&&t.squareArray[e][s].usedby!==h.i4&&(a=i)}a>0&&k(a-1)}(e,s)}})})}),(0,i.jsxs)("div",{className:"col",children:[(0,i.jsx)(d.default,{rescues:y.snapshots[N].rescues}),(0,i.jsx)(m.default,{gameid:j,client:s,nickname:w,msgs:T,setMsgs:F,participant:f})]})]}),(0,i.jsxs)("div",{className:"w3-display-container w3-teal examineFooterHeight",children:[(0,i.jsx)("div",{className:"w3-display-middle commonFontFamily",children:(0,i.jsxs)("div",{children:[N>0&&(0,i.jsx)("button",{className:"w3-black w3-round",onClick:function(){k(0)},children:(0,i.jsx)("i",{className:"material-icons",children:"fast_rewind"})}),N>0&&(0,i.jsx)("button",{className:"w3-black w3-round",onClick:function(){N-1>-1&&k(N-1)},children:(0,i.jsx)("i",{className:"material-icons",children:"arrow_left"})}),N<y.snapshots.length-1&&(0,i.jsx)("button",{className:"w3-black w3-round",onClick:z,children:(0,i.jsx)("i",{className:"material-icons",children:"arrow_right"})}),N<y.snapshots.length-1&&(0,i.jsx)("button",{className:"w3-black w3-round",onClick:function(){var e=y.snapshots.length-1;k(e)},children:(0,i.jsx)("i",{className:"material-icons",children:"fast_forward"})})]})}),(0,i.jsx)("div",{className:"w3-display-topleft commonFontFamily",children:(0,i.jsx)("p",{children:"\xa0Click on a move in the move list to jump to where it was played"})}),(0,i.jsx)("div",{className:"w3-display-bottomleft commonFontFamily",children:(0,i.jsx)("p",{children:"\xa0Click on a tile on the board to jump to where it was played"})}),(0,i.jsx)("div",{className:"w3-display-topright commonFontFamily",children:(0,i.jsxs)("div",{className:"pbTilerack",children:["Click on the ",(0,i.jsx)("span",{className:"pbTilerackArrowInFooter",children:" "})," by the rack to advance one move\xa0"]})})]})]})}},5916:function(e,s,a){"use strict";a.r(s);var i=a(5893),t=a(1385),n=a(7294),c=a(1664),r=a(7666),l=a(6595),o=a(3939),d="w3-button w3-border w3-blue w3-hover-black w3-round";s.default=function(e){var s=e.client,a=e.setIsrejoin,m=e.wsmessage,h=e.gameid,u=e.setGameid,p=e.nickname,b=e.setNickname,x=e.setParticipant,j=e.racksize,w=e.setRacksize,f=(0,n.useState)([]),v=f[0],N=f[1],k=(0,n.useState)([]),g=k[0],y=k[1];function S(e){return function(e){for(var s=0;s<v.length;++s)if(v[s].gameid===e)return s;return-1}(e)>-1}function C(e){return 0===p.length?0:e.pname===p?2:e.gname?3:0}function T(e){return 0===p.length?0:e.gname===p?2:e.gname?"Game over"===e.gamestatus?4:0:1}function F(e){w(e)}return(0,n.useEffect)((function(){""!==m&&function(e){var s=JSON.parse(e);if("pb"===s.type&&"chat"===s.func&&!s.gameid&&s.nickname!==p){var a=[].concat((0,t.Z)(g),[{from:s.nickname,msg:s.sendmsg}]);return void y(a)}if("pb"===s.type&&"gamelist"===s.func){var i=[];s.gamelist.forEach((function(e){var s={gameid:e.gameid,pname:e.pname,gname:e.gname,gamestatus:e.whoseturn===l.Bd?"Game over":"Unfinished",racksize:e.racksize};i.push(s)})),N([].concat(i))}}(m)}),[m]),(0,n.useEffect)((function(){(0,o.O)("ScrollableChat")}),[g]),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"w3-container w3-teal w3-bar",children:[(0,i.jsx)("h1",{className:"w3-bar-item w3-centre myHeadingFont",children:"Prison Break Lobby"}),(0,i.jsx)("div",{className:"w3-bar-item w3-right",children:(0,i.jsx)(c.default,{href:"../../",children:(0,i.jsx)("a",{children:(0,i.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})})]}),(0,i.jsxs)("div",{className:"w3-row",children:[(0,i.jsxs)("div",{className:"w3-col s9",children:[(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"All Participants ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Nickname:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"nickname",value:p,onChange:function(e){b(e.target.value)}})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"Prisoners ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Game ID:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"gameid",value:h,onChange:function(e){u(e.target.value)}})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Rack Size:"})})}),(0,i.jsxs)("div",{className:"w3-bar-item",children:[(0,i.jsxs)("div",{className:"w3-row",children:[(0,i.jsx)("button",{id:"selectracksize4",className:4===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return F(4)},"data-toggle":"tooltip",title:"4 letter racks, 9 x 9 board",autoFocus:!0,children:"4"}),(0,i.jsx)("button",{id:"selectracksize5",className:5===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return F(5)},"data-toggle":"tooltip",title:"5 letter racks, 11 x 11 board",children:"5"}),(0,i.jsx)("button",{id:"selectracksize6",className:6===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return F(6)},"data-toggle":"tooltip",title:"6 letter racks, 13 x 13 board",children:"6"}),(0,i.jsx)("button",{id:"selectracksize7",className:7===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return F(7)},"data-toggle":"tooltip",title:"7 letter racks, 15 x 15 board",children:"7"})]}),(0,i.jsx)("div",{className:"w3-row",children:(0,i.jsxs)("span",{className:"pbLobbyCellBlockInfo",children:[j," letter racks, ",2*j+1," x ",2*j+1," board."]})})]}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("button",{id:"startgame",className:d,onClick:function(){0===p.length?window.alert("Please enter nickname before starting a game"):h.length>0?S(h)?window.alert("Game already started with that id"):x(l.ap):window.alert("Please enter Game ID before starting a game")},children:"Start Game"})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"Guards ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("span",{className:"myCommonFont",children:(0,i.jsx)("h2",{children:'Find and click the "Join Game" button for your game.'})})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h1",{children:(0,i.jsx)("i",{className:"material-icons w3-right",children:"report_problem"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{className:"myCommonFont",children:'If you lost connection, find and click the "Reconnect" button for your nickname.'})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{className:"myCommonFont",children:(0,i.jsx)("b",{children:"Game list:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsxs)("table",{className:"w3-table-all w3-card-4",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"w3-blue h4 myCommonFont",children:[(0,i.jsx)("th",{className:"w3-border-right",children:"Game ID"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Prisoners"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Guards"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Rack Size"}),(0,i.jsx)("th",{children:"Game Status"})]})}),(0,i.jsx)("tbody",{children:v.map((function(e,s){return(0,i.jsxs)("tr",{className:"myCommonFont w3-hover-green",children:[(0,i.jsx)("td",{className:"w3-border-right",children:(0,i.jsx)("b",{children:e.gameid})}),2===C(e)?(0,i.jsx)("td",{id:"PrisonersRejoin".concat(s),className:"w3-border-right",children:(0,i.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){a(!0),u(e.gameid),x(l.ap),w(e.racksize)},children:"Reconnect"})}):3===C(e)?(0,i.jsx)("td",{id:"PrisonersObserve".concat(s),className:"w3-border-right",children:(0,i.jsx)("button",{className:"w3-button w3-yellow w3-round w3-hover-black",onClick:function(){a(!1),u(e.gameid),x(l.qg),w(e.racksize)},children:"Observe"})}):(0,i.jsx)("td",{id:"PrisonersNoAction".concat(s),className:"w3-border-right",children:"No action available"}),2===T(e)?(0,i.jsx)("td",{id:"GuardsRejoin".concat(s),className:"w3-border-right",children:(0,i.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){a(!0),u(e.gameid),x(l.b6),w(e.racksize)},children:"Reconnect"})}):1===T(e)?(0,i.jsx)("td",{id:"GuardsJoin".concat(s),className:"w3-border-right",children:(0,i.jsx)("button",{className:d,onClick:function(){u(e.gameid),x(l.b6),w(e.racksize)},children:"Join Game"})}):4===T(e)?(0,i.jsx)("td",{id:"GuardsExamine".concat(s),className:"w3-border-right",children:(0,i.jsx)("button",{className:d,onClick:function(){u(e.gameid),x(l.Vj),w(e.racksize)},children:"Examine Game"})}):(0,i.jsx)("td",{id:"GuardsNoAction".concat(s),className:"w3-border-right",children:"No action available"}),(0,i.jsx)("td",{id:"RackSize".concat(s),className:"w3-center w3-border-right",children:e.racksize}),(0,i.jsx)("td",{id:"GameStatus".concat(s),children:e.gamestatus})]},"OtherGame".concat(s))}))})]})})]})})]}),(0,i.jsx)("div",{className:"w3-col s3",children:(0,i.jsx)(r.default,{client:s,nickname:p,msgs:g,setMsgs:y})})]}),(0,i.jsx)("div",{className:"w3-container w3-teal",children:(0,i.jsx)("h1",{children:"Have fun!"})})]})}},3019:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return m}});var i=a(5893),t=a(7294),n=a(5518),c=a(5916),r=a(78),l=a(2389),o=a(6595),d=a(5877);function m(){var e=(0,t.useState)((0,d.v4)())[0],s=(0,t.useState)(!1),a=s[0],m=s[1],h=(0,t.useState)(""),u=h[0],p=h[1],b=(0,t.useState)(""),x=b[0],j=b[1],w=(0,t.useState)(o.dK),f=w[0],v=w[1],N=(0,t.useState)(""),k=N[0],g=N[1],y=(0,t.useState)(4),S=y[0],C=y[1],T="wss://tilerunner.herokuapp.com/?clientType=pb&thisisme="+e,F=(0,t.useState)(new n.Z(T,(function(e){g(e.data)}),"pb",e))[0];return(0,t.useEffect)((function(){return F.connect()}),[]),f===o.dK?(0,i.jsx)(c.default,{client:F,setIsrejoin:m,wsmessage:k,gameid:u,setGameid:p,nickname:x,setNickname:j,setParticipant:v,racksize:S,setRacksize:C}):f===o.Vj?(0,i.jsx)(l.default,{client:F,wsmessage:k,gameid:u,nickname:x,participant:f}):(0,i.jsx)(r.default,{isrejoin:a,participant:f,gameid:u,nickname:x,wsmessage:k,client:F,racksize:S})}},5518:function(e,s,a){"use strict";a.d(s,{Z:function(){return c}});var i=a(4047),t=a(2700),n=function(){function e(s,a){(0,i.Z)(this,e),this.callback=s,this.timerCalc=a,this.timer=null,this.tries=0}return(0,t.Z)(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}(),c=function(){function e(s,a,t,c){var r=this;(0,i.Z)(this,e),this.customSocket=null,this.socketUrl=s,this.clientType=t,this.thisisme=c,this.reconnectTimer=new n((function(){r.disconnect(),r.connect()}),this.reconnectAfterMs),this.messageFunction=a}return(0,t.Z)(e,[{key:"reconnectAfterMs",value:function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4}},{key:"connect",value:function(){var e=this;this.customSocket=new WebSocket(this.socketUrl),this.customSocket.onopen=function(s){e.send({type:e.clientType,func:"announce"})},this.customSocket.onclose=function(s){e.reconnectTimer.scheduleTimeout()},this.customSocket.onerror=function(e){},this.customSocket.onmessage=this.messageFunction}},{key:"disconnect",value:function(){this.customSocket.onclose=function(){},this.customSocket.close()}},{key:"send",value:function(e){e.thisisme=this.thisisme,e.clientType=this.clientType,this.customSocket.send(JSON.stringify(e))}}]),e}()},2137:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pb/prisonbreak",function(){return a(3019)}])}},function(e){e.O(0,[357,78,774,888,179],(function(){return s=2137,e(e.s=s);var s}));var s=e.O();_N_E=s}]);