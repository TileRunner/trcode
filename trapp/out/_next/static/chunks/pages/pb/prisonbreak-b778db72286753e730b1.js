(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{5916:function(e,t,s){"use strict";s.r(t);var i=s(5893),n=s(1385),a=s(7294),c=s(1664),r=s(7666),l=s(6595),o=s(3939),d="w3-button w3-border w3-blue w3-hover-black w3-round";t.default=function(e){var t=e.client,s=e.setIsrejoin,m=e.wsmessage,h=e.gameid,u=e.setGameid,b=e.nickname,w=e.setNickname,x=e.setParticipant,j=e.racksize,k=e.setRacksize,f=(0,a.useState)([]),N=f[0],g=f[1],v=(0,a.useState)([]),p=v[0],y=v[1];function S(e){return function(e){for(var t=0;t<N.length;++t)if(N[t].gameid===e)return t;return-1}(e)>-1}function z(e){return 0===b.length||e.whoseturn===l.Bd?0:e.gname?e.gname===b?2:0:1}function C(e){k(e)}return(0,a.useEffect)((function(){""!==m&&function(e){var t=JSON.parse(e);if("pb"===t.type&&"chat"===t.func&&!t.gameid&&t.nickname!==b){var s=[].concat((0,n.Z)(p),[{from:t.nickname,msg:t.sendmsg}]);return void y(s)}if("pb"===t.type&&"gamelist"===t.func){var i=[];t.gamelist.forEach((function(e){var t={gameid:e.gameid,pname:e.pname,gname:e.gname,gamestatus:e.whoseturn===l.Bd?"Game over":"Unfinished",racksize:e.racksize};i.push(t)})),g([].concat(i))}}(m)}),[m]),(0,a.useEffect)((function(){(0,o.O)("ScrollableChat")}),[p]),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"w3-container w3-teal w3-bar",children:[(0,i.jsx)("h1",{className:"w3-bar-item w3-centre myHeadingFont",children:"Prison Break Lobby"}),(0,i.jsx)("div",{className:"w3-bar-item w3-right",children:(0,i.jsx)(c.default,{href:"../../",children:(0,i.jsx)("a",{children:(0,i.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})})]}),(0,i.jsxs)("div",{className:"w3-row",children:[(0,i.jsxs)("div",{className:"w3-col s9",children:[(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"All Participants ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Nickname:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"nickname",value:b,onChange:function(e){w(e.target.value)}})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"Prisoners ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Game ID:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"gameid",value:h,onChange:function(e){u(e.target.value)}})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("b",{children:"Rack Size:"})})}),(0,i.jsxs)("div",{className:"w3-bar-item",children:[(0,i.jsxs)("div",{className:"w3-row",children:[(0,i.jsx)("button",{id:"selectracksize4",className:4===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(4)},"data-toggle":"tooltip",title:"4 letter racks, 9 x 9 board",autoFocus:!0,children:"4"}),(0,i.jsx)("button",{id:"selectracksize5",className:5===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(5)},"data-toggle":"tooltip",title:"5 letter racks, 11 x 11 board",children:"5"}),(0,i.jsx)("button",{id:"selectracksize6",className:6===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(6)},"data-toggle":"tooltip",title:"6 letter racks, 13 x 13 board",children:"6"}),(0,i.jsx)("button",{id:"selectracksize7",className:7===j?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(7)},"data-toggle":"tooltip",title:"7 letter racks, 15 x 15 board",children:"7"})]}),(0,i.jsx)("div",{className:"w3-row",children:(0,i.jsxs)("span",{className:"pbLobbyCellBlockInfo",children:[j," letter racks, ",2*j+1," x ",2*j+1," board."]})})]}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("button",{id:"startgame",className:d,onClick:function(){0===b.length?window.alert("Please enter nickname before starting a game"):h.length>0?S(h)?window.alert("Game already started with that id"):x(l.ap):window.alert("Please enter Game ID before starting a game")},children:"Start Game"})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{children:(0,i.jsx)("span",{className:"pbPlayerTitle",children:"Guards ~"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("span",{className:"myCommonFont",children:(0,i.jsx)("h2",{children:'Find and click the "Join Game" button for your game.'})})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h1",{children:(0,i.jsx)("i",{className:"material-icons w3-right",children:"report_problem"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{className:"myCommonFont",children:'If you lost connection, find and click the "Reconnect" button for your nickname.'})})]})}),(0,i.jsx)("div",{className:"w3-container",children:(0,i.jsxs)("div",{className:"w3-bar",children:[(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsx)("h3",{className:"myCommonFont",children:(0,i.jsx)("b",{children:"Game list:"})})}),(0,i.jsx)("div",{className:"w3-bar-item",children:(0,i.jsxs)("table",{className:"w3-table-all w3-card-4",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"w3-blue h4 myCommonFont",children:[(0,i.jsx)("th",{className:"w3-border-right",children:"Game ID"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Prisoners"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Guards"}),(0,i.jsx)("th",{className:"w3-border-right",children:"Rack Size"}),(0,i.jsx)("th",{children:"Game Status"})]})}),(0,i.jsx)("tbody",{children:N.map((function(e,t){return(0,i.jsxs)("tr",{className:"myCommonFont w3-hover-green",children:[(0,i.jsx)("td",{className:"w3-border-right",children:(0,i.jsx)("b",{children:e.gameid})}),2===(n=e,0===b.length||n.whoseturn===l.Bd?0:n.pname===b?2:0)?(0,i.jsx)("td",{id:"PrisonersRejoin".concat(t),className:"w3-border-right",children:(0,i.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){s(!0),u(e.gameid),x(l.ap),k(e.racksize)},children:"Reconnect"})}):(0,i.jsx)("td",{id:"PrisonersNoAction".concat(t),className:"w3-border-right",children:"No action available"}),2===z(e)?(0,i.jsx)("td",{id:"GuardsRejoin".concat(t),className:"w3-border-right",children:(0,i.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){s(!0),u(e.gameid),x(l.b6),k(e.racksize)},children:"Reconnect"})}):1===z(e)?(0,i.jsx)("td",{id:"GuardsJoin".concat(t),className:"w3-border-right",children:(0,i.jsx)("button",{className:d,onClick:function(){u(e.gameid),x(l.b6),k(e.racksize)},children:"Join Game"})}):(0,i.jsx)("td",{id:"GuardsNoAction".concat(t),className:"w3-border-right",children:"No action available"}),(0,i.jsx)("td",{id:"RackSize".concat(t),className:"w3-center w3-border-right",children:e.racksize}),(0,i.jsx)("td",{id:"GameStatus".concat(t),children:e.gamestatus})]},"OtherGame".concat(t));var n}))})]})})]})})]}),(0,i.jsx)("div",{className:"w3-col s3",children:(0,i.jsx)(r.default,{client:t,nickname:b,msgs:p,setMsgs:y})})]}),(0,i.jsx)("div",{className:"w3-container w3-teal",children:(0,i.jsx)("h1",{children:"Have fun!"})})]})}},8527:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var i=s(5893),n=s(7294),a=s(4047),c=s(2700),r=function(){function e(t,s){(0,a.Z)(this,e),this.callback=t,this.timerCalc=s,this.timer=null,this.tries=0}return(0,c.Z)(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}(),l=function(){function e(t,s,i,n){var c=this;(0,a.Z)(this,e),this.customSocket=null,this.socketUrl=t,this.clientType=i,this.thisisme=n,this.reconnectTimer=new r((function(){c.disconnect(),c.connect()}),this.reconnectAfterMs),this.messageFunction=s}return(0,c.Z)(e,[{key:"reconnectAfterMs",value:function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4}},{key:"connect",value:function(){var e=this;this.customSocket=new WebSocket(this.socketUrl),this.customSocket.onopen=function(t){e.send({type:e.clientType,func:"announce"})},this.customSocket.onclose=function(t){e.reconnectTimer.scheduleTimeout()},this.customSocket.onerror=function(e){},this.customSocket.onmessage=this.messageFunction}},{key:"disconnect",value:function(){this.customSocket.onclose=function(){},this.customSocket.close()}},{key:"send",value:function(e){e.thisisme=this.thisisme,e.clientType=this.clientType,this.customSocket.send(JSON.stringify(e))}}]),e}(),o=s(5916),d=s(1658),m=s(6595),h=s(5877);function u(){var e=(0,n.useState)((0,h.v4)())[0],t=(0,n.useState)(!1),s=t[0],a=t[1],c=(0,n.useState)(""),r=c[0],u=c[1],b=(0,n.useState)(""),w=b[0],x=b[1],j=(0,n.useState)(m.dK),k=j[0],f=j[1],N=(0,n.useState)(""),g=N[0],v=N[1],p=(0,n.useState)(4),y=p[0],S=p[1],z="wss://tilerunner.herokuapp.com/?clientType=pb&thisisme="+e,C=(0,n.useState)(new l(z,(function(e){v(e.data)}),"pb",e))[0];return(0,n.useEffect)((function(){return C.connect()}),[]),k===m.dK?(0,i.jsx)(o.default,{client:C,setIsrejoin:a,wsmessage:g,gameid:r,setGameid:u,nickname:w,setNickname:x,setParticipant:f,racksize:y,setRacksize:S}):(0,i.jsx)(d.default,{isrejoin:s,participant:k,gameid:r,nickname:w,wsmessage:g,client:C,racksize:y})}},2137:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pb/prisonbreak",function(){return s(8527)}])}},function(e){e.O(0,[997,658,774,888,179],(function(){return t=2137,e(e.s=t);var t}));var t=e.O();_N_E=t}]);