_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[16],{"M+XG":function(e,t,c){"use strict";c.r(t);var n=c("nKUr"),s=c("KQm4"),i=c("q1tI"),a=c("YFqc"),r=c.n(a),o=c("gx3M"),l=c("EzCb"),d="w3-button w3-border w3-blue w3-hover-black w3-round",b=function(e){var t=document.getElementById(e);t.scrollTop=t.scrollHeight};t.default=function(e){var t=e.client,c=e.setIsrejoin,a=e.wsmessage,m=e.gameid,j=e.setGameid,u=e.nickname,h=e.setNickname,w=e.setParticipant,f=e.racksize,O=e.setRacksize,x=Object(i.useState)([]),p=x[0],g=x[1],k=Object(i.useState)([]),v=k[0],N=k[1];function y(e){return function(e){for(var t=0;t<p.length;++t)if(p[t].gameid===e)return t;return-1}(e)>-1}function S(e){return 0===u.length||e.whoseturn===l.y?0:e.gname?e.gname===u?2:0:1}function C(e){O(e)}return Object(i.useEffect)((function(){""!==a&&function(e){var t=JSON.parse(e);if("pb"===t.type&&"chat"===t.func&&!t.gameid&&t.nickname!==u){var c=[].concat(Object(s.a)(v),[{from:t.nickname,msg:t.sendmsg}]);return void N(c)}if("pb"===t.type&&"gamelist"===t.func){var n=[];t.gamelist.forEach((function(e){var t={gameid:e.gameid,pname:e.pname,gname:e.gname,gamestatus:e.whoseturn===l.y?"Game over":"Unfinished",racksize:e.racksize};n.push(t)})),g([].concat(n))}}(a)}),[a]),Object(i.useEffect)((function(){b("ScrollableChat")}),[v]),Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"w3-container w3-teal w3-bar",children:[Object(n.jsx)("h1",{className:"w3-bar-item w3-centre myHeadingFont",children:"Prison Break Lobby"}),Object(n.jsx)("div",{className:"w3-bar-item w3-right",children:Object(n.jsx)(r.a,{href:"../../",children:Object(n.jsx)("a",{children:Object(n.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})})]}),Object(n.jsxs)("div",{className:"w3-row",children:[Object(n.jsxs)("div",{className:"w3-col s9",children:[Object(n.jsx)("div",{className:"w3-container",children:Object(n.jsxs)("div",{className:"w3-bar",children:[Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("span",{className:"pbPlayerTitle",children:"All Participants ~"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("b",{children:"Nickname:"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"nickname",value:u,onChange:function(e){h(e.target.value)}})})]})}),Object(n.jsx)("div",{className:"w3-container",children:Object(n.jsxs)("div",{className:"w3-bar",children:[Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("span",{className:"pbPlayerTitle",children:"Prisoners ~"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("b",{children:"Game ID:"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("input",{className:"w3-input w3-border w3-blue myCommonFont",type:"text",name:"gameid",value:m,onChange:function(e){j(e.target.value)}})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("b",{children:"Rack Size:"})})}),Object(n.jsxs)("div",{className:"w3-bar-item",children:[Object(n.jsxs)("div",{className:"w3-row",children:[Object(n.jsx)("button",{id:"selectracksize4",className:4===f?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(4)},"data-toggle":"tooltip",title:"4 letter racks, 9 x 9 board",autoFocus:!0,children:"4"}),Object(n.jsx)("button",{id:"selectracksize5",className:5===f?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(5)},"data-toggle":"tooltip",title:"5 letter racks, 11 x 11 board",children:"5"}),Object(n.jsx)("button",{id:"selectracksize6",className:6===f?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(6)},"data-toggle":"tooltip",title:"6 letter racks, 13 x 13 board",children:"6"}),Object(n.jsx)("button",{id:"selectracksize7",className:7===f?"pbLobbyRackSizeSelected":"pbLobbyRackSize",onClick:function(){return C(7)},"data-toggle":"tooltip",title:"7 letter racks, 15 x 15 board",children:"7"})]}),Object(n.jsx)("div",{className:"w3-row",children:Object(n.jsxs)("span",{className:"pbLobbyCellBlockInfo",children:[f," letter racks, ",2*f+1," x ",2*f+1," board."]})})]}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("button",{id:"startgame",className:d,onClick:function(){0===u.length?window.alert("Please enter nickname before starting a game"):m.length>0?y(m)?window.alert("Game already started with that id"):w(l.q):window.alert("Please enter Game ID before starting a game")},children:"Start Game"})})]})}),Object(n.jsx)("div",{className:"w3-container",children:Object(n.jsxs)("div",{className:"w3-bar",children:[Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{children:Object(n.jsx)("span",{className:"pbPlayerTitle",children:"Guards ~"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("span",{className:"myCommonFont",children:Object(n.jsx)("h2",{children:'Find and click the "Join Game" button for your game.'})})})]})}),Object(n.jsx)("div",{className:"w3-container",children:Object(n.jsxs)("div",{className:"w3-bar",children:[Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h1",{children:Object(n.jsx)("i",{className:"material-icons w3-right",children:"report_problem"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{className:"myCommonFont",children:'If you lost connection, find and click the "Reconnect" button for your nickname.'})})]})}),Object(n.jsx)("div",{className:"w3-container",children:Object(n.jsxs)("div",{className:"w3-bar",children:[Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsx)("h3",{className:"myCommonFont",children:Object(n.jsx)("b",{children:"Game list:"})})}),Object(n.jsx)("div",{className:"w3-bar-item",children:Object(n.jsxs)("table",{className:"w3-table-all w3-card-4",children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{className:"w3-blue h4 myCommonFont",children:[Object(n.jsx)("th",{className:"w3-border-right",children:"Game ID"}),Object(n.jsx)("th",{className:"w3-border-right",children:"Prisoners"}),Object(n.jsx)("th",{className:"w3-border-right",children:"Guards"}),Object(n.jsx)("th",{className:"w3-border-right",children:"Rack Size"}),Object(n.jsx)("th",{children:"Game Status"})]})}),Object(n.jsx)("tbody",{children:p.map((function(e,t){return Object(n.jsxs)("tr",{className:"myCommonFont w3-hover-green",children:[Object(n.jsx)("td",{className:"w3-border-right",children:Object(n.jsx)("b",{children:e.gameid})}),2===(s=e,0===u.length||s.whoseturn===l.y?0:s.pname===u?2:0)?Object(n.jsx)("td",{id:"PrisonersRejoin".concat(t),className:"w3-border-right",children:Object(n.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){c(!0),j(e.gameid),w(l.q),O(e.racksize)},children:"Reconnect"})}):Object(n.jsx)("td",{id:"PrisonersNoAction".concat(t),className:"w3-border-right",children:"No action available"}),2===S(e)?Object(n.jsx)("td",{id:"GuardsRejoin".concat(t),className:"w3-border-right",children:Object(n.jsx)("button",{className:"w3-button w3-red w3-round w3-hover-black",onClick:function(){c(!0),j(e.gameid),w(l.p),O(e.racksize)},children:"Reconnect"})}):1===S(e)?Object(n.jsx)("td",{id:"GuardsJoin".concat(t),className:"w3-border-right",children:Object(n.jsx)("button",{className:d,onClick:function(){j(e.gameid),w(l.p),O(e.racksize)},children:"Join Game"})}):Object(n.jsx)("td",{id:"GuardsNoAction".concat(t),className:"w3-border-right",children:"No action available"}),Object(n.jsx)("td",{id:"RackSize".concat(t),className:"w3-center w3-border-right",children:e.racksize}),Object(n.jsx)("td",{id:"GameStatus".concat(t),children:e.gamestatus})]},"OtherGame".concat(t));var s}))})]})})]})})]}),Object(n.jsx)("div",{className:"w3-col s3",children:Object(n.jsx)(o.default,{client:t,nickname:u,msgs:v,setMsgs:N})})]}),Object(n.jsx)("div",{className:"w3-container w3-teal",children:Object(n.jsx)("h1",{children:"Have fun!"})})]})}},dsDM:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pb/prisonbreak",function(){return c("fLLM")}])},fLLM:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return k}));var n=c("nKUr"),s=c("q1tI");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var c=0;c<t.length;c++){var n=t[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,c){return t&&a(e.prototype,t),c&&a(e,c),e}var o,l=function(){function e(t,c){i(this,e),this.callback=t,this.timerCalc=c,this.timer=null,this.tries=0}return r(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}(),d=function(){function e(t,c,n,s){var a=this;i(this,e),this.customSocket=null,this.socketUrl=t,this.clientType=n,this.thisisme=s,this.reconnectTimer=new l((function(){a.disconnect(),a.connect()}),this.reconnectAfterMs),this.messageFunction=c}return r(e,[{key:"reconnectAfterMs",value:function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4}},{key:"connect",value:function(){var e=this;this.customSocket=new WebSocket(this.socketUrl),this.customSocket.onopen=function(t){e.send({type:e.clientType,func:"announce"})},this.customSocket.onclose=function(t){e.reconnectTimer.scheduleTimeout()},this.customSocket.onerror=function(e){},this.customSocket.onmessage=this.messageFunction}},{key:"disconnect",value:function(){this.customSocket.onclose=function(){},this.customSocket.close()}},{key:"send",value:function(e){e.thisisme=this.thisisme,e.clientType=this.clientType,this.customSocket.send(JSON.stringify(e))}}]),e}(),b=c("M+XG"),m=c("yhjZ"),j=c("EzCb"),u=new Uint8Array(16);function h(){if(!o&&!(o="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(u)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var f=function(e){return"string"===typeof e&&w.test(e)},O=[],x=0;x<256;++x)O.push((x+256).toString(16).substr(1));var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=(O[e[t+0]]+O[e[t+1]]+O[e[t+2]]+O[e[t+3]]+"-"+O[e[t+4]]+O[e[t+5]]+"-"+O[e[t+6]]+O[e[t+7]]+"-"+O[e[t+8]]+O[e[t+9]]+"-"+O[e[t+10]]+O[e[t+11]]+O[e[t+12]]+O[e[t+13]]+O[e[t+14]]+O[e[t+15]]).toLowerCase();if(!f(c))throw TypeError("Stringified UUID is invalid");return c};var g=function(e,t,c){var n=(e=e||{}).random||(e.rng||h)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){c=c||0;for(var s=0;s<16;++s)t[c+s]=n[s];return t}return p(n)};function k(){var e=Object(s.useState)(g())[0],t=Object(s.useState)(!1),c=t[0],i=t[1],a=Object(s.useState)(""),r=a[0],o=a[1],l=Object(s.useState)(""),u=l[0],h=l[1],w=Object(s.useState)(j.r),f=w[0],O=w[1],x=Object(s.useState)(""),p=x[0],k=x[1],v=Object(s.useState)(4),N=v[0],y=v[1],S="wss://tilerunner.herokuapp.com/?clientType=pb&thisisme="+e,C=Object(s.useState)(new d(S,(function(e){k(e.data)}),"pb",e))[0];return Object(s.useEffect)((function(){return C.connect()}),[]),f===j.r?Object(n.jsx)(b.default,{client:C,setIsrejoin:i,wsmessage:p,gameid:r,setGameid:o,nickname:u,setNickname:h,setParticipant:O,racksize:N,setRacksize:y}):Object(n.jsx)(m.default,{isrejoin:c,participant:f,gameid:r,nickname:u,wsmessage:p,client:C,racksize:N})}}},[["dsDM",0,1,2,3,4]]]);