_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[9],{"2Skw":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pb/prisonbreak2",function(){return n("UOmD")}])},KQm4:function(e,t,n){"use strict";function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function c(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,"a",(function(){return c}))},UOmD:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var s=n("nKUr"),c=n("KQm4"),r=n("q1tI"),a=n("YFqc"),i=n.n(a);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var d=function(){function e(t,n){o(this,e),this.callback=t,this.timerCalc=n,this.timer=null,this.tries=0}return u(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}(),b=function(){function e(t,n){var s=this;o(this,e),this.customSocket=null,this.socketUrl=t,this.reconnectTimer=new d((function(){s.disconnect(),s.connect()}),this.reconnectAfterMs),this.messageFunction=n}return u(e,[{key:"reconnectAfterMs",value:function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4}},{key:"connect",value:function(){var e=this;this.customSocket=new WebSocket(this.socketUrl),this.customSocket.onopen=function(t){console.log("connected to "+e.socketUrl),e.send(JSON.stringify({type:"announce",func:"announce"}))},this.customSocket.onclose=function(t){e.reconnectTimer.scheduleTimeout()},this.customSocket.onerror=function(e){},this.customSocket.onmessage=this.messageFunction}},{key:"disconnect",value:function(){this.customSocket.onclose=function(){},this.customSocket.close()}},{key:"send",value:function(e){this.customSocket.send(JSON.stringify(e))}}]),e}(),j=13,h=12,p=j,f=12,m=["Escapee: \"I'm free! I'm free!\". Little kid: \"I'm four! I'm four!\"","Two peanuts were walking down a back alley. One was a salted."],O=["0-0","0-6","0-12","6-0","6-12","12-0","12-6","12-12"],g=["A","A","A","A","A","A","B","B","C","C","C","D","D","D","E","E","E","E","E","E","E","E","E","F","G","G","H","H","I","I","I","I","I","I","J","K","L","L","L","L","M","M","N","N","N","N","O","O","O","O","O","P","P","Q","R","R","R","R","R","S","S","S","S","S","S","S","T","T","T","T","U","U","U","V","W","X","Y","Z","?","?"],y=".",v="",x=Array(j).fill(Array(p).fill(y)),k=Array(j).fill(Array(p).fill(v)),N="";function w(){var e=Object(r.useState)(!1),t=e[0],n=e[1],c=Object(r.useState)(""),a=c[0],i=c[1],o=Object(r.useState)(""),l=o[0],u=o[1],d=Object(r.useState)(""),j=d[0],h=d[1],p=Object(r.useState)(""),f=p[0],m=p[1],O=Object(r.useState)(!1),g=O[0],y=O[1],v=Object(r.useState)(new b("wss://tilerunner.herokuapp.com",(function(e){m(e.data)})))[0];return Object(r.useEffect)((function(){return v.connect()}),[]),""===j?Object(s.jsx)(S,{setIsrejoin:n,wsmessage:f,gameid:a,setGameid:i,nickname:l,setNickname:u,setPrisonersOrGuards:h,upsidedownMode:g,setUpsidedownMode:y}):Object(s.jsx)(C,{isrejoin:t,prisonersOrGuards:j,gameid:a,nickname:l,wsmessage:f,client:v,upsidedownMode:g})}var S=function(e){var t=e.setIsrejoin,n=e.wsmessage,a=e.gameid,o=e.setGameid,l=e.nickname,u=e.setNickname,d=e.setPrisonersOrGuards,b=e.upsidedownMode,j=e.setUpsidedownMode,h=Object(r.useState)([]),p=h[0],f=h[1];function m(e){for(var t=0;t<p.length;++t)if(p[t].gameid===e)return t;return-1}function O(e){return 0===l.length||"Game over"===e.gamestatus?0:e.playingP?e.nicknameP===l?3:0:1}function g(e){return 0===l.length||"Game over"===e.gamestatus?0:e.playingG?e.nicknameG===l?3:0:2}return Object(r.useEffect)((function(){""!==n&&function(e){try{var t=JSON.parse(e),n=t.gameid,s=t.nickname,r=t.whoseturn;if(n&&n.length>0&&r&&r.length>0){var a=!1,i=t.sender,o=Object(c.a)(p),l=m(n),u="P"===i||l>-1&&p[l].playingP,d="G"===i||l>-1&&p[l].playingG,b="Unknown";"X"===r?b="Game over":"P"===r?b="Prisoners turn":"G"===r&&(b="Guards turn");var j={gameid:n,nicknameP:"P"===i?s:l>-1?p[l].nicknameP:"",nicknameG:"G"===i?s:l>-1?p[l].nicknameG:"",gamestatus:b,playingP:u,playingG:d};if(l<0)a=!0,o=[].concat(Object(c.a)(o),[j]);else{var h=p[l];h.nicknameP===j.nicknameP&&h.nicknameG===j.nicknameG&&h.gamestatus===j.gamestatus&&h.playingP===j.playingP&&h.playingG===j.playingG||(a=!0,o[l]=j)}a&&f(o)}}catch(O){window.alert("Error processing lobby message")}}(n)}),[n]),Object(s.jsxs)("div",{className:"container-fluid",children:[Object(s.jsxs)("div",{className:"row",children:[Object(s.jsxs)("div",{className:"col-10 pbtitle",children:["Prison Break Lobby",Object(s.jsx)("span",{className:"material-icons",children:"run_circle"})]}),Object(s.jsx)("div",{className:"col-2 pbhomelink",children:Object(s.jsx)(i.a,{href:"../../",children:Object(s.jsx)("a",{children:Object(s.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})})]}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsxs)("div",{className:"col-10 offset-1 h2",children:[Object(s.jsx)("label",{children:"*Nickname:\xa0"}),Object(s.jsx)("input",{name:"nickname",value:l,onChange:function(e){u(e.target.value)}}),Object(s.jsx)("span",{children:"\xa0(*required)"})]}),Object(s.jsxs)("div",{class:"custom-control custom-checkbox h3 col offset-2",children:[Object(s.jsx)("input",{type:"checkbox",id:"upsidedownModeCheckbox",className:"custom-control-input",value:b,onChange:function(){j((function(e){return!e}))}}),Object(s.jsx)("label",{className:"custom-control-label",for:"upsidedownModeCheckbox",children:"\xa0Upside board on opponents turn"})]})]}),Object(s.jsx)("div",{className:"row",children:Object(s.jsxs)("div",{className:"col-7 offset-1",children:[Object(s.jsx)("hr",{}),Object(s.jsx)("span",{className:"pbPlayerTitle h2",children:"\xa0PRISONERS\xa0"}),Object(s.jsx)("span",{className:"h3",children:'\xa0\xa0Enter a game id, select options and click "Start Game".'})]})}),Object(s.jsx)("div",{className:"row",children:Object(s.jsx)("div",{className:"col-7 offset-1",children:Object(s.jsxs)("span",{class:"h2",children:[Object(s.jsx)("span",{class:"h1",children:"\xa0"}),"\xa0\xa0\xa0Game id:\xa0",Object(s.jsx)("input",{name:"gameid",value:a,onChange:function(e){o(e.target.value)}}),Object(s.jsx)("button",{id:"startgame",className:"pbLobbyActionButton",onClick:function(){a.length>0&&(!function(e){var t=m(e);return!(t<0)&&p[t].playingP}(a)?d("P"):window.alert("Prisoners already playing that game"))},children:"Start Game"})]})})}),Object(s.jsx)("div",{className:"row",children:Object(s.jsxs)("div",{className:"col-7 offset-1",children:[Object(s.jsx)("hr",{}),Object(s.jsxs)("span",{className:"pbPlayerTitle h2",children:[Object(s.jsx)("i",{className:"material-icons",children:"security"}),"GUARDS",Object(s.jsx)("i",{className:"material-icons",children:"security"})]}),Object(s.jsx)("span",{className:"h3",children:'\xa0\xa0Find and click the "Join Game" button for your game.'}),Object(s.jsx)("hr",{}),Object(s.jsx)("h3",{children:'If you lost connection, find and click the "Reconnect" button for your game id.'})]})}),Object(s.jsx)("div",{className:"row",children:Object(s.jsx)("div",{className:"col offset-1",children:Object(s.jsx)("h1",{children:"Game list:"})})}),Object(s.jsx)("div",{className:"row",children:Object(s.jsx)("div",{className:"col offset-2",children:Object(s.jsxs)("table",{children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{className:"pbLobbyGamesHeader",children:[Object(s.jsx)("th",{className:"pbLobbyGamesHeaderCol",children:"Game ID"}),Object(s.jsx)("th",{className:"pbLobbyGamesHeaderCol",colSpan:"2",children:"Prisoners"}),Object(s.jsx)("th",{className:"pbLobbyGamesHeaderCol",colSpan:"2",children:"Guards"}),Object(s.jsx)("th",{className:"pbLobbyGamesHeaderCol",children:"Game status"})]})}),Object(s.jsx)("tbody",{children:p.map((function(e,n){return Object(s.jsxs)("tr",{className:"pbGamesInProgressRow",children:[Object(s.jsx)("td",{className:"pbLobbyGameid",children:e.gameid}),Object(s.jsx)("td",{className:"pbLobbyPlayerIndicator",children:Object(s.jsx)("span",{className:"material-icons",children:e.playingP?"check_circle":"cancel"})}),0===O(e)?Object(s.jsx)("td",{className:"pbLobbyActionNone",children:"No action available"}):3===O(e)?Object(s.jsx)("td",{id:"PrisonersRejoin".concat(n),children:Object(s.jsx)("button",{className:"pbLobbyActionButton",onClick:function(){t(!0),o(e.gameid),d("P")},children:"Reconnect"})}):Object(s.jsx)("td",{id:"PrisonersStart".concat(n),children:Object(s.jsx)("button",{className:"pbLobbyActionButton",onClick:function(){o(e.gameid),d("P")},children:"Start Game"})}),Object(s.jsx)("td",{className:"pbLobbyPlayerIndicator",children:Object(s.jsx)("span",{className:"material-icons",children:e.playingG?"check_circle":"cancel"})}),0===g(e)?Object(s.jsx)("td",{className:"pbLobbyActionNone",children:"No action available"}):3===g(e)?Object(s.jsx)("td",{id:"GuardsRejoin".concat(n),children:Object(s.jsx)("button",{className:"pbLobbyActionButton",onClick:function(){t(!0),o(e.gameid),d("G")},children:"Reconnect"})}):Object(s.jsx)("td",{id:"GuardsJoin".concat(n),children:Object(s.jsx)("button",{className:"pbLobbyActionButton",onClick:function(){o(e.gameid),d("G")},children:"Join Game"})}),Object(s.jsx)("td",{className:"pbLobbyGameStatus",children:e.gamestatus})]},"OtherGame".concat(n))}))})]})})})]})},G=function(e){var t="P"===e.squareusedby?"pbSquareUsedByPrisoners":"pbSquareUsedByGuards",n=e.c!==y?t:e.rcd[0]===e.ri&&e.rcd[1]===e.ci&&"r"===e.rcd[2]?"pbSquareRightArrow":e.rcd[0]===e.ri&&e.rcd[1]===e.ci&&"d"===e.rcd[2]?"pbSquareDownArrow":6===e.ri&&6===e.ci?"pbSquareCenterSquare":0!==e.ri&&6!==e.ri&&e.ri!==h||0!==e.ci&&6!==e.ci&&e.ci!==f?e.ri%2===e.ci%2?"pbSquare1":"pbSquare2":"pbSquareEscapeHatch",c=e.c!==y?e.c:"pbSquareRightArrow"===n?"\u27a1":"pbSquareDownArrow"===n?"\u2b07":"pbSquareCenterSquare"===n?Object(s.jsx)("i",{className:"material-icons",children:"stars"}):"pbSquareEscapeHatch"===n?"\ua415":(e.ri,e.ci,".");return"pbSquareEscapeHatch"===n?Object(s.jsx)("button",{className:n,onClick:e.onClick,children:Object(s.jsx)("span",{className:"material-icons",children:"run_circle"})}):Object(s.jsx)("button",{className:n,onClick:e.onClick,children:c})},P=function(e){var t=e.onClick,n=e.squares,c=e.usedby,r=e.rcd,a=function(e){return Object(s.jsx)("tr",{className:"pbRow",children:n[e].map((function(n,a){return function(e,n,c,a){return Object(s.jsx)("td",{className:"pbSquare",children:Object(s.jsx)(G,{c:c,ci:n,ri:e,squareusedby:a,rcd:r,onClick:function(){return t(e,n)}})},"Square".concat(e,"-").concat(n))}(e,a,n,c[e][a])}))},"BoardRow".concat(e))};return Object(s.jsx)("table",{className:"pbBoard",children:Object(s.jsx)("tbody",{children:n.map((function(e,t){return a(t)}))})})},C=function(e){var t=e.isrejoin,n=e.prisonersOrGuards,a=e.gameid,o=e.nickname,l=e.wsmessage,u=e.client,d=e.upsidedownMode,b=g,w=Object(r.useState)(Object(c.a)(b)),S=w[0],G=w[1],C=Object(r.useState)([]),T=C[0],E=C[1],A=Object(r.useState)([]),I=A[0],R=A[1],_=Object(r.useState)(Object(c.a)(x)),J=_[0],B=_[1],U=Object(r.useState)(Object(c.a)(k)),D=U[0],H=U[1],F=Object(r.useState)(-1),X=F[0],K=F[1],z=Object(r.useState)("P"),Y=z[0],Q=z[1],V=Object(r.useState)([]),W=V[0],Z=V[1],$=Object(r.useState)(0),ee=$[0],te=$[1],ne=Object(r.useState)([-1,-1,N]),se=ne[0],ce=ne[1],re=Object(r.useState)(!1),ae=re[0],ie=re[1],oe=Object(r.useState)({squares:Object(c.a)(x),usedby:Object(c.a)(k),ptiles:[],gtiles:[]}),le=oe[0],ue=oe[1];Object(r.useEffect)((function(){var e=setInterval((function(){n!==Y&&"X"!==Y&&(console.log("Interval: prisonersOrGuards="+n+" whoseturn="+Y+" at "+Date().toLocaleString()),fe())}),2e4);return function(){return clearInterval(e)}}),[Y]),Object(r.useEffect)((function(){if(t||"P"!==n)try{u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"requestgamedata",sender:n}))}catch(l){}else{for(var e=[],s=[],r=Object(c.a)(b);e.length<6;){var i=Math.floor(Math.random()*r.length);e.push(r[i]),r.splice(i,1),i=Math.floor(Math.random()*r.length),s.push(r[i]),r.splice(i,1)}e.sort(),s.sort(),R(s),E(e),G(r),ue({squares:Object(c.a)(x),usedby:Object(c.a)(k),ptiles:[].concat(e),gtiles:[].concat(s)}),u.send(JSON.stringify({type:"pb",func:"hello",sender:n,gameid:a,nickname:o,whoseturn:Y}))}}),[]),Object(r.useEffect)((function(){""!==l&&function(e){var t=JSON.parse(e);"announce"===t.type?u.send(JSON.stringify({type:"pb",func:"hello",sender:n,gameid:a,nickname:o,whoseturn:Y})):t.gameid===a&&"pb"===t.type&&("requestgamedata"===t.func&&t.sender!==n&&u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"providegamedata",sender:n,tiles:S,squares:J,ptiles:T,gtiles:I,usedby:D,whoseturn:Y,selection:X,currentcoords:W,snapshot:le,passed:ae,rescues:ee})),"providegamedata"===t.func&&t.sender!==n&&Y!==n&&"X"!==Y&&(G(t.tiles),B(t.squares),E(t.ptiles),R(t.gtiles),H(t.usedby),Q(t.whoseturn),K(t.selection),Z(t.currentcoords),ue(t.snapshot),ie(t.passed),te(t.rescues)),"ept"===t.func&&(Q(t.whoseturn),K(-1),ce(-1,-1,N),Z([]),B(t.squares),H(t.usedby),E(t.ptiles),G(t.tiles),ie(t.passed),te(t.rescues),ue({squares:Object(c.a)(t.squares),usedby:Object(c.a)(t.usedby),ptiles:Object(c.a)(t.ptiles),gtiles:Object(c.a)(I)})),"egt"===t.func&&(Q(t.whoseturn),K(-1),ce(-1,-1,N),Z([]),B(t.squares),H(t.usedby),R(t.gtiles),G(t.tiles),ie(t.passed),ue({squares:Object(c.a)(t.squares),usedby:Object(c.a)(t.usedby),ptiles:Object(c.a)(T),gtiles:Object(c.a)(t.gtiles)})))}(l)}),[l]);var de=function(e,t,n,s){var r=Object(c.a)(J),a=Object(c.a)(D),i=Object(c.a)(T),o=Object(c.a)(I),l=Object(c.a)(J[e]),u=J[e][t],d=Object(c.a)(W),b=String(e)+"-"+String(t),j=W.indexOf(b);if(-1===n&&(n=X,s=se),n>-1&&u===y){l[t]="P"===Y?i[n]:o[n],r[e]=Object(c.a)(l),"P"===Y?i.splice(n,1):o.splice(n,1);var h=Object(c.a)(a[e]);return h[t]=Y,a[e]=Object(c.a)(h),"P"===Y&&n===i.length&&(n-=1),"G"===Y&&n===o.length&&(n-=1),K(n),B(r),H(a),E(i),R(o),Z([].concat(Object(c.a)(W),[b])),void ce(s)}if(j>-1){"P"===Y?i.push(u):o.push(u);var p=Object(c.a)(r[e]);p[t]=y,r[e]=Object(c.a)(p);var f=Object(c.a)(a[e]);return f[t]=v,a[e]=Object(c.a)(f),K("P"===Y?i.length-1:o.length-1),d.splice(j,1),B(r),H(a),E(i),R(o),Z(d),void ce(-1,-1,N)}if(J[e][t]!==y);else{var m=se[0]!==e||se[1]!==t?"r":"r"===se[2]?"d":"d"===se[2]?N:"r";ce(s=[e,t,m])}},be=function(){if(he()){for(var e=ee,t=0;t<W.length;t++)O.indexOf(W[t])>-1&&(e+=1);for(var s=Object(c.a)(T),r=Object(c.a)(S);s.length<6&&r.length>0;){var i=Math.floor(Math.random()*r.length);s.push(r[i]),r.splice(i,1)}s.sort();var l=s.length>0?"G":"X";D[0][0]!==v&&D[0][6]!==v&&D[0][12]!==v&&D[6][0]!==v&&D[6][12]!==v&&D[12][0]!==v&&D[12][6]!==v&&D[12][12]!==v&&(l="X"),Q(l),K(-1),Z([]),E(s),G(r),ie(!1),te(e),ue({squares:Object(c.a)(J),usedby:Object(c.a)(D),ptiles:Object(c.a)(s),gtiles:Object(c.a)(I)}),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"ept",sender:n,squares:J,usedby:D,ptiles:s,tiles:r,whoseturn:l,passed:!1,rescues:e}))}},je=function(){if(he()){for(var e=Object(c.a)(I),t=Object(c.a)(S);e.length<6&&t.length>0;){var s=Math.floor(Math.random()*t.length);e.push(t[s]),t.splice(s,1)}e.sort();var r=Object(c.a)(J),i=Object(c.a)(D),l=Object(c.a)(T),d=Object(c.a)(I),b=e.length>0?"P":"X";D[0][0]!==v&&D[0][6]!==v&&D[0][12]!==v&&D[6][0]!==v&&D[6][12]!==v&&D[12][0]!==v&&D[12][6]!==v&&D[12][12]!==v&&(b="X"),Q(b),K(-1),Z([]),R(e),G(t),ie(!1),ue({squares:r,usedby:i,ptiles:l,gtiles:d}),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"egt",sender:n,squares:J,usedby:D,gtiles:e,tiles:t,passed:!1,whoseturn:b}))}};function he(){if(J[6][6]===y)return window.alert("First play must hit center square"),!1;for(var e=j,t=-1,n=p,s=-1,c=0;c<j;++c)for(var r=0;r<p;++r)if(J[c][r]!==y){if(!(c>0&&J[c-1][r]!==y)&&!(r>0&&J[c][r-1]!==y)&&!(c<h&&J[c+1][r]!==y)&&!(r<f&&J[c][r+1]!==y))return window.alert("Each played tile must be part of a word"),!1;le.squares[c][r]===y&&(c<e&&(e=c),c>t&&(t=c),r<n&&(n=r),r>s&&(s=r))}if(e===j)return window.alert("You didn't play any tiles"),!1;if(e!==t&&n!==s)return window.alert("Tiles played must be in a straight line"),!1;var a=!1,i=!1;for(c=e;c<=t;++c)for(r=n;r<=s;++r){if(J[c][r]===y)return window.alert("There is a gap in your word"),!1;le.squares[c][r]!==y&&(a=!0),e===t&&c>0&&J[c-1][r]!==y&&(i=!0),e===t&&c<h&&J[c+1][r]!==y&&(i=!0),n===s&&r>0&&J[c][r-1]!==y&&(i=!0),n===s&&r<f&&J[c][r+1]!==y&&(i=!0)}return e===t&&n>0&&le.squares[e][n-1]!==y&&(a=!0),e===t&&s<f&&le.squares[e][s+1]!==y&&(a=!0),n===s&&e>0&&le.squares[e-1][n]!==y&&(a=!0),n===s&&t<h&&le.squares[t+1][n]!==y&&(a=!0),!(!a&&!i&&le.squares[6][6]!==y)||(window.alert("Words must be connected"),!1)}var pe=function(){B(Object(c.a)(le.squares)),H(Object(c.a)(le.usedby)),E(Object(c.a)(le.ptiles)),R(Object(c.a)(le.gtiles)),K(-1),Z([])},fe=function(){u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",sender:n,whoseturn:Y,func:"requestgamedata"}))};return Object(s.jsxs)("div",{className:"container-fluid prisonbreak",onKeyDownCapture:function(e){if(e.preventDefault(),n===Y)if("Enter"!==e.key){if(e.key.match(/^[A-Za-z\?]$/)){var t=e.key.toUpperCase(),s="P"===Y?T:I,r=s.indexOf(t);if(-1===r&&(r=s.indexOf("?")),r>-1){var a=se[0],i=se[1],o=se[2];if(a>-1&&i>-1&&o!==N){if("r"===o){for(var l=-1,u=i+1;u<p&&-1===l;u++)J[a][u]===y&&(l=u);return void de(a,i,r,-1===l?[-1,-1,N]:[a,l,"r"])}if("d"===o){for(var d=-1,b=a+1;b<j&&-1===d;b++)J[b][i]===y&&(d=b);return void de(a,i,r,-1===d?[-1,-1,N]:[d,i,"d"])}}}}else if("Backspace"===e.key&&W.length>0){var h=W[W.length-1],f=Object(c.a)(W),m=Object(c.a)(T),O=Object(c.a)(I),g=Object(c.a)(D),x=Object(c.a)(J),k=[-1,-1,N],w=X;f.splice(W.length-1,1);var S=parseInt(h.split("-")[0]),G=parseInt(h.split("-")[1]),P=J[S][G];"P"===Y?(m.push(P),w=m.length-1):(O.push(P),w=O.length-1),g[S][G]=v,x[S][G]=y;var C=se[2];C!==N&&(k=[S,G,C],1===W.length&&(w=-1)),Z(f),R(O),E(m),B(x),H(g),ce(k),K(w)}}else"P"===Y?be():je()},children:[Object(s.jsxs)("div",{className:"row",children:[Object(s.jsxs)("div",{className:"col-2 pbGameid",children:["Game id: ",a,Object(s.jsx)("br",{}),"Nickname: ",o]}),Object(s.jsxs)("div",{className:"col-8 pbtitle",children:["Prison Break",Object(s.jsx)("span",{className:"material-icons",children:"run_circle"})]}),Object(s.jsx)("div",{className:"col-2 pbhomelink",children:Object(s.jsx)(i.a,{href:"../../",children:Object(s.jsx)("a",{children:Object(s.jsx)("i",{className:"material-icons","data-toggle":"tooltip",title:"Home",children:"home"})})})})]}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"col pbPrisoners",children:Object(s.jsx)(M,{ptiles:T,whoseturn:Y,selection:X,onClick:function(e){return t=e,void("P"===Y?K(t):alert("It is not your turn"));var t},onClickFinishTurn:function(){return be()},onClickTileRecall:function(){return pe()},onClickTileExchange:function(){return function(){if(S.length<6)window.alert("Need 6 tiles in the bag to exchange");else{for(var e=[],t=Object(c.a)(S);e.length<6&&t.length>0;){var s=Math.floor(Math.random()*t.length);e.push(t[s]),t.splice(s,1)}e.sort(),(t=[].concat(Object(c.a)(t),Object(c.a)(le.ptiles))).sort(),B(Object(c.a)(le.squares)),H(Object(c.a)(le.usedby)),Q("G"),K(-1),Z([]),E(e),G(t),ie(!1),ue({squares:Object(c.a)(le.squares),usedby:Object(c.a)(le.usedby),ptiles:[].concat(e),gtiles:Object(c.a)(I)}),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"ept",sender:n,whoseturn:"G",squares:le.squares,usedby:le.usedby,ptiles:e,tiles:t,passed:!1,rescues:ee}))}}()},onClickPassPlay:function(){return function(){pe();var e=ae?"X":"G";Q(e),ie(!0),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"ept",sender:n,squares:le.squares,usedby:le.usedby,ptiles:le.ptiles,tiles:S,whoseturn:e,passed:!0,rescues:ee}))}()},rescues:ee,prisonersOrGuards:n})}),Object(s.jsxs)("div",{className:"col",children:[n===Y?Object(s.jsx)("div",{className:"row",children:Object(s.jsx)(P,{squares:J,usedby:D,rcd:se,onClick:function(e,t){return de(e,t,-1,null)}})}):"X"!==Y&&d?Object(s.jsx)("div",{className:"row upsidedown",children:Object(s.jsx)(P,{squares:J,usedby:D,rcd:se,onClick:function(){}})}):Object(s.jsx)("div",{className:"row",children:Object(s.jsx)(P,{squares:J,usedby:D,rcd:se,onClick:function(){}})}),Object(s.jsx)("div",{className:"row pbUnderboard",children:"X"===Y?Object(s.jsx)("h1",{children:"Game Over!"}):Object(s.jsx)("p",{children:"P"===Y?m[0]:m[1]})})]}),Object(s.jsx)("div",{className:"col pbGuards",children:Object(s.jsx)(L,{gtiles:I,whoseturn:Y,selection:X,onClick:function(e){return t=e,void("G"===Y?K(t):alert("It is not your turn"));var t},onClickFinishTurn:function(){return je()},onClickTileRecall:function(){return pe()},onClickTileExchange:function(){return function(){if(S.length<6)window.alert("Need 6 tiles in the bag to exchange");else{for(var e=[],t=Object(c.a)(S);e.length<6&&t.length>0;){var s=Math.floor(Math.random()*t.length);e.push(t[s]),t.splice(s,1)}e.sort(),(t=[].concat(Object(c.a)(t),Object(c.a)(le.gtiles))).sort(),B(Object(c.a)(le.squares)),H(Object(c.a)(le.usedby)),Q("P"),K(-1),Z([]),R(e),G(t),ie(!1),ue({squares:Object(c.a)(le.squares),usedby:Object(c.a)(le.usedby),ptiles:Object(c.a)(T),gtiles:[].concat(e)}),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"egt",sender:n,whoseturn:"P",squares:le.squares,usedby:le.usedby,gtiles:e,tiles:t,passed:!1}))}}()},onClickPassPlay:function(){return function(){pe();var e=ae?"X":"P";Q(e),ie(!0),u.send(JSON.stringify({gameid:a,nickname:o,type:"pb",func:"egt",sender:n,squares:le.squares,usedby:le.usedby,gtiles:le.gtiles,tiles:S,whoseturn:e,passed:!0}))}()},prisonersOrGuards:n})}),Object(s.jsx)("div",{className:"col",children:Object(s.jsx)(q,{tiles:S,othertiles:"P"===n?I:T})})]})]})},q=function(e){var t=[].concat(Object(c.a)(e.tiles),Object(c.a)(e.othertiles));return t.sort(),"?"===t[0]&&(t.splice(0,1),t.push("?")),"?"===t[0]&&(t.splice(0,1),t.push("?")),Object(s.jsxs)("div",{className:"pbTilepool",children:[Object(s.jsx)("span",{className:"pbTilepoolTitle",children:"TILES"}),Object(s.jsx)("div",{className:"pbTilepoolDivider"}),t.map((function(e,n){return Object(s.jsxs)("span",{children:[n>0&&e!==t[n-1]?Object(s.jsx)("div",{className:"pbTilepoolDivider"}):Object(s.jsx)(s.Fragment,{}),Object(s.jsx)("span",{className:"pbTilepoolTile",children:e})]},"tile".concat(n))}))]})},T=function(e){return Object(s.jsx)("span",{className:e.tileclass,onClick:e.onClick,children:e.tilevalue})},E=function(e){return Object(s.jsx)("button",{className:"pbActionButton",onClick:e.onClick,children:Object(s.jsxs)("span",{className:"pbActionButtonText",children:[Object(s.jsx)("i",{className:"material-icons",children:"check"}),"\xa0Finish Turn"]})})},A=function(e){return Object(s.jsx)("button",{className:"pbActionButton",onClick:e.onClick,children:Object(s.jsxs)("span",{className:"pbActionButtonText",children:[Object(s.jsx)("i",{className:"material-icons",children:"undo"}),"\xa0Recall Tiles"]})})},I=function(e){return Object(s.jsx)("button",{className:"pbActionButton",onClick:e.onClick,children:Object(s.jsxs)("span",{className:"pbActionButtonText",children:[Object(s.jsx)("i",{className:"material-icons",children:"cached"}),"\xa0Swap Tiles"]})})},R=function(e){return Object(s.jsx)("button",{className:"pbActionButton",onClick:e.onClick,children:Object(s.jsxs)("span",{className:"pbActionButtonText",children:[Object(s.jsx)("i",{className:"material-icons",children:"not_interested"}),"\xa0Pass Turn"]})})},M=function(e){var t,n=_(e);return Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{className:"pbPlayerTitle",children:[Object(s.jsx)("i",{className:"material-icons",children:"run_circle run_circle run_circle"}),"\xa0PRISONERS\xa0",Object(s.jsx)("i",{className:"material-icons",children:"run_circle run_circle run_circle"})]}),Object(s.jsx)("p",{className:"pbTilerack",children:e.ptiles.map((function(t,s){return n("P"===e.whoseturn&&e.selection===s?"pbTileOnRackSelectedP":"pbTileOnRackP",s,"P"===e.prisonersOrGuards?t:"*")}))}),"P"===e.whoseturn&&"P"===e.prisonersOrGuards?J(e):Object(s.jsx)(s.Fragment,{}),Object(s.jsxs)("p",{children:["Rescues made: ",e.rescues,Object(s.jsx)("br",{}),(t=e.rescues,Array(t).fill("nonsense").map((function(e,t){return Object(s.jsx)("span",{"data-toggle":"tooltip",title:"I'm free! I'm free!",children:Object(s.jsx)("img",{src:"/breakfree.png",alt:"I'm free! I'm free!",width:"100",height:"100"})},e+String(t))})))]})]})},L=function(e){var t=_(e);return Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{className:"pbPlayerTitle",children:[Object(s.jsx)("i",{className:"material-icons",children:"security security security"}),"\xa0GUARDS\xa0",Object(s.jsx)("i",{className:"material-icons",children:"security security security"})]}),Object(s.jsx)("p",{className:"pbTilerack",children:e.gtiles.map((function(n,s){return t("G"===e.whoseturn&&e.selection===s?"pbTileOnRackSelectedG":"pbTileOnRackG",s,"G"===e.prisonersOrGuards?n:"*")}))}),"G"===e.whoseturn&&"G"===e.prisonersOrGuards?J(e):Object(s.jsx)(s.Fragment,{})]})};function _(e){return function(t,n,c){return"*"!==c?Object(s.jsx)(T,{tileclass:t,tilevalue:c,onClick:function(){return e.onClick(n)}},t+String(n)):Object(s.jsx)(T,{tileclass:t,tilevalue:c,onClick:function(){return window.alert("No peeking!")}},t+String(n))}}function J(e){return Object(s.jsxs)("div",{className:"pbActionButtonDiv",children:[Object(s.jsx)("p",{children:Object(s.jsx)(E,{onClick:function(){return e.onClickFinishTurn()}})}),Object(s.jsx)("p",{children:Object(s.jsx)(A,{onClick:function(){return e.onClickTileRecall()}})}),Object(s.jsx)("p",{children:Object(s.jsx)(I,{onClick:function(){return e.onClickTileExchange()}})}),Object(s.jsx)("p",{children:Object(s.jsx)(R,{onClick:function(){return e.onClickPassPlay()}})})]})}},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var s=n("J4zp"),c=n("284h");t.__esModule=!0,t.default=void 0;var r=c(n("q1tI")),a=n("elyg"),i=n("nOHt"),o=n("vNVm"),l={};function u(e,t,n,s){if(e&&(0,a.isLocalURL)(t)){e.prefetch(t,n,s).catch((function(e){0}));var c=s&&"undefined"!==typeof s.locale?s.locale:e&&e.locale;l[t+"%"+n+(c?"%"+c:"")]=!0}}var d=function(e){var t=!1!==e.prefetch,n=(0,i.useRouter)(),c=n&&n.pathname||"/",d=r.default.useMemo((function(){var t=(0,a.resolveHref)(c,e.href,!0),n=s(t,2),r=n[0],i=n[1];return{href:r,as:e.as?(0,a.resolveHref)(c,e.as):i||r}}),[c,e.href,e.as]),b=d.href,j=d.as,h=e.children,p=e.replace,f=e.shallow,m=e.scroll,O=e.locale;"string"===typeof h&&(h=r.default.createElement("a",null,h));var g=r.Children.only(h),y=g&&"object"===typeof g&&g.ref,v=(0,o.useIntersection)({rootMargin:"200px"}),x=s(v,2),k=x[0],N=x[1],w=r.default.useCallback((function(e){k(e),y&&("function"===typeof y?y(e):"object"===typeof y&&(y.current=e))}),[y,k]);(0,r.useEffect)((function(){var e=N&&t&&(0,a.isLocalURL)(b),s="undefined"!==typeof O?O:n&&n.locale,c=l[b+"%"+j+(s?"%"+s:"")];e&&!c&&u(n,b,j,{locale:s})}),[j,b,N,O,t,n]);var S={ref:w,onClick:function(e){g.props&&"function"===typeof g.props.onClick&&g.props.onClick(e),e.defaultPrevented||function(e,t,n,s,c,r,i,o){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,a.isLocalURL)(n))&&(e.preventDefault(),null==i&&(i=s.indexOf("#")<0),t[c?"replace":"push"](n,s,{shallow:r,locale:o,scroll:i}).then((function(e){e&&i&&document.body.focus()})))}(e,n,b,j,p,f,m,O)},onMouseEnter:function(e){(0,a.isLocalURL)(b)&&(g.props&&"function"===typeof g.props.onMouseEnter&&g.props.onMouseEnter(e),u(n,b,j,{priority:!0}))}};if(e.passHref||"a"===g.type&&!("href"in g.props)){var G="undefined"!==typeof O?O:n&&n.locale,P=(0,a.getDomainLocale)(j,G,n&&n.locales,n&&n.domainLocales);S.href=P||(0,a.addBasePath)((0,a.addLocale)(j,G,n&&n.defaultLocale))}return r.default.cloneElement(g,S)};t.default=d},vNVm:function(e,t,n){"use strict";var s=n("J4zp"),c=n("TqRt");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,n=e.disabled||!i,c=(0,r.useRef)(),l=(0,r.useState)(!1),u=s(l,2),d=u[0],b=u[1],j=(0,r.useCallback)((function(e){c.current&&(c.current(),c.current=void 0),n||d||e&&e.tagName&&(c.current=function(e,t,n){var s=function(e){var t=e.rootMargin||"",n=o.get(t);if(n)return n;var s=new Map,c=new IntersectionObserver((function(e){e.forEach((function(e){var t=s.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return o.set(t,n={id:t,observer:c,elements:s}),n}(n),c=s.id,r=s.observer,a=s.elements;return a.set(e,t),r.observe(e),function(){a.delete(e),r.unobserve(e),0===a.size&&(r.disconnect(),o.delete(c))}}(e,(function(e){return e&&b(e)}),{rootMargin:t}))}),[n,t,d]);return(0,r.useEffect)((function(){i||d||(0,a.default)((function(){return b(!0)}))}),[d]),[j,d]};var r=n("q1tI"),a=c(n("0G5g")),i="undefined"!==typeof IntersectionObserver;var o=new Map}},[["2Skw",0,2,1,3]]]);